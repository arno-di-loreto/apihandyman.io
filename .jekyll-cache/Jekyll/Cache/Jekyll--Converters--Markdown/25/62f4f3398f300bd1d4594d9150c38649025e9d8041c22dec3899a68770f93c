I"×Ü<p>Do you need to make a repetitive task that could be done through an API instead of a UI?
Do you need to make many API calls but donâ€™t want to code?
This post is made for you: youâ€™ll learn to use Postman and CSV files to batch API calls.
You may also learn a thing or two about API design, Github APIs (yes, plural) and other Postman features (variables, security, command line, visualizer, â€¦) in the making.
If you never have used Postman or Github APIs, no problem, everything will be explained.
<!--more--></p>

<h1 id="about-the-problem-and-solution">About the problem and solution</h1>

<p>While the problem and solution are quite simple, itâ€™s a great occasion to learn many things.</p>

<h2 id="the-problem-to-solve">The problem to solve</h2>

<p>I think itâ€™s Garfield, a famous philosopher, who once said <em>Laziness is the mother of invention</em>.
Every time I have a repetitive task to do, I always try to find a way to let machine do it for me.
As Iâ€™m the API Handyman, it often ends by taking advantage of an API.
Recently, I had to create many issues in some <em>random issue tracker</em> based on some data in my emails.
Hopefully, that issue tracker comes with an API and I could easily get the input data in a structure way by a simple copy/paste from my email client.
So instead of having to laboriously fill N times a form, I had to make N API calls with structured data as input, and Postman can help to do that.</p>

<h2 id="what-youll-learn-while-solving-it">What youâ€™ll learn while solving it</h2>

<p>In order to keep this demonstration easy to redo by anyone, weâ€™ll use the github API to create issues on a dummy public repository with data coming from a CSV file.</p>

<p>In this post, youâ€™ll learn to use Postman (UI) and Newman (command line):</p>
<ul>
  <li>Create Postman workspace, collections and requests</li>
  <li>Make REST GET and POST (with body) API calls</li>
  <li>Define and use variables</li>
  <li>Configure a collection to make secured API call</li>
  <li>Run all requests of a collection with data coming from a CSV file with Postman</li>
  <li>Export collections and environments</li>
  <li>Run all requests of a collection with data coming from a CSV file in a terminal with Newman</li>
  <li>Make GraphQL API calls</li>
  <li>Setup a visualizer to render API call results</li>
</ul>

<p>Youâ€™ll also learn use Github REST and GraphQL APIs:</p>
<ul>
  <li>Get a personal access token to call Github APIs (REST or GraphQL)</li>
  <li>Get current user data (REST)</li>
  <li>List a repositoryâ€™s issues (REST)</li>
  <li>Add an issue to a repository (REST)</li>
  <li>Delete an issue (GraphQL)</li>
</ul>

<p>And we will talk about some principles of API design:</p>
<ul>
  <li>Predictable design</li>
  <li>Error design</li>
  <li>Be careful when copying others (especially famous companies)</li>
</ul>

<h1 id="setting-up-postman-for-a-first-github-api-call">Setting up Postman for a first Github API call</h1>

<p>Postman is a wonderful tool that I have been using for many years to make API calls.
It has constantly evolved over the years and now supports many cool features; it is now advertized as â€œThe Collaboration Platform for API Development (note: this post is not sponsored by Postman).
Go to <a href="https://www.postman.com/downloads/">https://www.postman.com/downloads/</a> to download and install Postman, if you donâ€™t already have it.
You can also use the browser version (but youâ€™ll have to create an account).
Our first Github API call will retrieve current user information.</p>

<h2 id="trying-to-make-a-first-api-call">Trying to make a first API call</h2>

<p>Launch Postman, weâ€™ll create a â€œPostman CSV Demoâ€ workspace, a â€œGithubâ€ collection, a â€œList current userâ€ request calling <code>GET https://api.github.com/user</code> (see <a href="https://docs.github.com/en/rest/reference/users#get-the-authenticated-user">Github REST API documentation</a>) and make our first call:</p>

<table class="tutorial-steps">
<tr>
    <td><img src="/images/batch-github-api-call-with-csv-and-postman-runner-and-visualizer/postman-top-menubar.png" class="image-simple" alt="Workspaces" /></td>
    <td>In top <em>menu bar</em>, click on <img src="/images/batch-github-api-call-with-csv-and-postman-runner-and-visualizer/postman-workspaces-menu.png" class="image-inline" alt="Workspaces" /></td>
</tr>
<tr>
    <td><img src="/images/batch-github-api-call-with-csv-and-postman-runner-and-visualizer/postman-workspaces-menu-top.png" class="image-simple" alt="+ New Workspace" /></td>
    <td>Click on <img src="/images/batch-github-api-call-with-csv-and-postman-runner-and-visualizer/postman-plus-workspace-button.png" class="image-inline" alt="+ New Workspace" /> button</td>
</tr>
<tr>
    <td><img src="/images/batch-github-api-call-with-csv-and-postman-runner-and-visualizer/postman-create-workspace-name.png" class="image-simple" alt="Create workspace window name field" /></td>
    <td>Set workspace name to â€œPostman CSV Demoâ€</td>
</tr>
<tr>
    <td><img src="/images/batch-github-api-call-with-csv-and-postman-runner-and-visualizer/postman-create-workspace-visibility.png" class="image-simple" alt="Create workspace window visibility drop list" /></td>
    <td>Change visibility to â€œPersonalâ€</td>
</tr>
<tr>
    <td><img src="/images/batch-github-api-call-with-csv-and-postman-runner-and-visualizer/postman-create-workspace-buttons.png" class="image-simple" alt="Create workspace window buttons" /></td>
    <td>Click on â€œCreate Workspaceâ€ button</td>
</tr>
<tr>
    <td><img src="/images/batch-github-api-call-with-csv-and-postman-runner-and-visualizer/postman-workspace-created.png" class="image-simple" alt="Workspace created" /></td>
    <td>Click on <img src="/images/batch-github-api-call-with-csv-and-postman-runner-and-visualizer/postman-new-button.png" class="image-inline" alt="New" /> button next to â€œPostman CSV Demoâ€ workspace name</td>
</tr>
<tr>
    <td><img src="/images/batch-github-api-call-with-csv-and-postman-runner-and-visualizer/postman-create-collection-button.png" class="image-simple" alt="Create collection button" /></td>
    <td>Click on â€œCollectionâ€ item in the â€œCreate Newâ€ window</td>
</tr>
<tr>
    <td><img src="/images/batch-github-api-call-with-csv-and-postman-runner-and-visualizer/postman-collection-created.png" class="image-simple" alt="Collection created" /></td>
    <td>Change â€œNew Collectionâ€ name to â€œGithubâ€</td>
</tr>
<tr>
    <td><img src="/images/batch-github-api-call-with-csv-and-postman-runner-and-visualizer/postman-collection-right-click-add-request.png" class="image-simple" alt="Collection contextual menu" /></td>
    <td>Right click on the â€œGithubâ€ collection in the left panel and select â€œAdd requestâ€</td>
</tr>
<tr>
    <td><img src="/images/batch-github-api-call-with-csv-and-postman-runner-and-visualizer/postman-request-created-read-current-user.png" class="image-simple" alt="Request created" /></td>
    <td>Change â€œNew Requestâ€ name to â€œRead current userâ€</td>
</tr>
<tr>
    <td><img src="/images/batch-github-api-call-with-csv-and-postman-runner-and-visualizer/postman-request-url-set.png" class="image-simple" alt="URL set" /></td>
    <td>Set request URL to <code>https://api.github.com/user</code>, click on <img src="/images/batch-github-api-call-with-csv-and-postman-runner-and-visualizer/postman-save-button.png" class="image-inline" alt="Save button" /> and hit the <img src="/images/batch-github-api-call-with-csv-and-postman-runner-and-visualizer/postman-send-button.png" class="image-inline" alt="Send button" /> button â€¦</td>
</tr>
<tr>
    <td><img src="/images/batch-github-api-call-with-csv-and-postman-runner-and-visualizer/postman-request-failed-authorization.png" class="image-simple" alt="Response telling authorization is required" /></td>
    <td>â€¦ to get a 401 Unauthorized error telling that authentication is required</td>
</tr>
</table>

<h2 id="getting-a-github-personal-access-token">Getting a Github personal access token</h2>

<p>The easiest way to get access to the Github API, if you have two factor authentication activated (and you MUST have it activated), is to generate a personal access token.
For our demonstration we will generate one granting access to public repositories:</p>

<table class="tutorial-steps">
<tr>
    <td><img src="/images/batch-github-api-call-with-csv-and-postman-runner-and-visualizer/github-profile-menu.png" class="image-simple" alt="Github profile menu" /></td>
    <td>Go to your <a href="https://github.com/settings/profile">Github account settings</a> by clicking on your profile icon and clicking on â€œSettingsâ€ (at the bottom)</td>
</tr>
<tr>
    <td><img src="/images/batch-github-api-call-with-csv-and-postman-runner-and-visualizer/github-settings-menu.png" class="image-simple" alt="Github settings menu" /></td>
    <td>Scroll down and click on <a href="https://github.com/settings/apps">Developer setting</a> in the left menu</td>
</tr>
<tr>
    <td><img src="/images/batch-github-api-call-with-csv-and-postman-runner-and-visualizer/github-developer-settings.png" class="image-simple" alt="Github settings menu" /></td>
    <td>In developer setting page, click on <a href="https://github.com/settings/tokens">Personal access tokens</a></td>
</tr>
<tr>
    <td><img src="/images/batch-github-api-call-with-csv-and-postman-runner-and-visualizer/github-personal-access-tokens.png" class="image-simple" alt="Github personal access tokens" /></td>
    <td>Click on <a href="https://github.com/settings/tokens/new">Generate new token</a> (you may have to provide your password)</td>
</tr>
<tr>
    <td><img src="/images/batch-github-api-call-with-csv-and-postman-runner-and-visualizer/github-token-description.png" class="image-simple" alt="Github token description" /></td>
    <td>In the â€œNoteâ€ field, type â€œpostman-csv-demoâ€</td>
</tr>
<tr>
    <td><img src="/images/batch-github-api-call-with-csv-and-postman-runner-and-visualizer/github-scopes-public.png" class="image-simple" alt="Public repo scope checked" /></td>
    <td>Check the <code>public_repo</code> scope under repo. Note that this scopes obviously gives access to public repositories only, if you want to access private ones, youâ€™ll have to check the <code>repo</code> scope (which is less obvious).</td>
</tr>
<tr>
    <td><img src="/images/batch-github-api-call-with-csv-and-postman-runner-and-visualizer/github-token-validate.png" class="image-simple" alt="Github token generate button" /></td>
    <td>Click on <img src="/images/batch-github-api-call-with-csv-and-postman-runner-and-visualizer/github-token-generate-button.png" class="image-inline" alt="Generate token button" /> at the bottom of the page</td>
</tr>
<tr>
    <td><img src="/images/batch-github-api-call-with-csv-and-postman-runner-and-visualizer/github-token-generated.png" class="image-simple" alt="Github token generated" /></td>
    <td>Copy the generated token by clicking on <img src="/images/batch-github-api-call-with-csv-and-postman-runner-and-visualizer/github-token-copy-button.png" class="image-inline" alt="Copy button" /> (use this token with caution, never, ever, commit this value in any public source code repository!)</td>
</tr>
</table>

<h2 id="configuring-authorization-in-postman-and-make-a-successful-first-api-call">Configuring Authorization in Postman and make a successful first API call</h2>

<p>Having an access token, weâ€™ll configure our collection in order to make all requests that it will contain use it.
But we will do that in a secure way using an environment variable, itâ€™s a best practice that allows to share collections without the risk of sharing sensitive data:</p>

<table class="tutorial-steps">
<tr>
    <td><img src="/images/batch-github-api-call-with-csv-and-postman-runner-and-visualizer/postman-workspace-created.png" class="image-simple" alt="Workspace created" /></td>
    <td>Click on <img src="/images/batch-github-api-call-with-csv-and-postman-runner-and-visualizer/postman-new-button.png" class="image-inline" alt="New" /> button next to "Postman CSV Demo" workspace name</td>
</tr>
<tr>
    <td><img src="/images/batch-github-api-call-with-csv-and-postman-runner-and-visualizer/postman-create-environment-button.png" class="image-simple" alt="Create environment button" /></td>
    <td>Click on "Environment" item in the "Create New" window</td>
</tr>
<tr>
    <td><img src="/images/batch-github-api-call-with-csv-and-postman-runner-and-visualizer/postman-environment-created.png" class="image-simple" alt="Environment created" /></td>
    <td>Change "New Environment" name to "Github"</td>
</tr>
<tr>
    <td><img src="/images/batch-github-api-call-with-csv-and-postman-runner-and-visualizer/postman-environment-github-token.png" class="image-simple" alt="Github token variable" /></td>
    <td>Add a <code>github_token</code> variable and paste the Github token in its initial value and click outside the field (<em>That should populate also the current value</em>)</td>
</tr>
<tr>
    <td><img src="/images/batch-github-api-call-with-csv-and-postman-runner-and-visualizer/postman-environment-github-to-save.png" class="image-simple" alt="Github token variable to save" /></td>
    <td>Click on <img src="/images/batch-github-api-call-with-csv-and-postman-runner-and-visualizer/postman-save-button.png" class="image-inline" alt="Save button" /> to save the â€œGithubâ€ environment and its <code>github_token</code> variable</td>
</tr>
<tr>
    <td><img src="/images/batch-github-api-call-with-csv-and-postman-runner-and-visualizer/postman-environment-select-github.png" class="image-simple" alt="Activate Github environment" /></td>
    <td>In the upper left corner, click on â€œNo Environmentâ€ and select the newly created â€œGithubâ€ environment in order to make its variables accessible</td>
</tr>
<tr>
    <td><img src="/images/batch-github-api-call-with-csv-and-postman-runner-and-visualizer/postman-collection-auth-type.png" class="image-simple" alt="Collection authorization type" /></td>
    <td>Click on the â€œGithubâ€ collectionâ€™s name, in the Authorization tab, change Type from â€œNo Authâ€ to â€œBearer Tokenâ€</td>
</tr>
<tr>
    <td><img src="/images/batch-github-api-call-with-csv-and-postman-runner-and-visualizer/postman-collection-auth-token.png" class="image-simple" alt="Collection authorization type" /></td>
    <td>Set token value to <code>{{github_token}}</code> (<em>If the value is red instead of orange, it means the variable is not found. Itâ€™s probably because you didnâ€™t select the â€œGithubâ€ environment</em>)</td>
</tr>
<tr>
    <td><img src="/images/batch-github-api-call-with-csv-and-postman-runner-and-visualizer/postman-collection-to-save.png" class="image-simple" alt="Collection to save" /></td>
    <td>Click on <img src="/images/batch-github-api-call-with-csv-and-postman-runner-and-visualizer/postman-save-button.png" class="image-inline" alt="Save button" /> (<em>if you donâ€™t youâ€™ll get a 401</em>)</td>
</tr>
<tr>
    <td><img src="/images/batch-github-api-call-with-csv-and-postman-runner-and-visualizer/postman-request-success.png" class="image-simple" alt="200 OK response" /></td>
    <td>Go to the â€œRead current userâ€ request and hit <img src="/images/batch-github-api-call-with-csv-and-postman-runner-and-visualizer/postman-send-button.png" class="image-inline" alt="Send button" /> again â€¦ now it works! You should get a 200 OK response along with your userâ€™s data.</td>
</tr>
</table>

<h1 id="creating-one-to-many-issues-with-github-rest-api">Creating one to many issues with Github REST API</h1>

<p>Now that everything has been set up, letâ€™s list issues and create one to many.
We will work with a dummy repository, its URL on Github website will be something like <em>https://github.com</em><strong>/user/repo</strong>.
To list issues, weâ€™ll send a GET <em>https://api.github.com/repos</em><strong>/user/repo</strong><em>/issues</em> request and to create an issue weâ€™ll to send a POST request on the same URL.
Using GET on a collection resource to list things and POST on the same resource to create a thing that totally makes sense, weâ€™ll discover that unfortunately Github API does not always make sense.</p>

<h2 id="listing-issues">Listing issues</h2>

<p>Letâ€™s first create our dummy repository with UI and list issues with API:</p>

<table class="tutorial-steps">
<tr>
    <td><img src="/images/batch-github-api-call-with-csv-and-postman-runner-and-visualizer/github-repository-issues.png" class="image-simple" alt="Github repo issues" /></td>
    <td>Go to your <a href="https://github.com">Github account</a> and <a href="https://github.com/new">create</a> a new public repository, then go to the issues tab and copy the <code>/user/repo/issues</code> part of the newly created repositoryâ€™s URL</td>
</tr>
<tr>
    <td><img src="/images/batch-github-api-call-with-csv-and-postman-runner-and-visualizer/postman-collection-dots-menu.png" class="image-simple" alt="Postman collection menu" /></td>
    <td>In Postman, click on the <img src="/images/batch-github-api-call-with-csv-and-postman-runner-and-visualizer/postman-dots-button.png" class="image-inline" alt="... button" /> button on â€œGithubâ€ collection and select â€œAdd requestâ€</td>
</tr>
<tr>
    <td><img src="/images/batch-github-api-call-with-csv-and-postman-runner-and-visualizer/postman-request-new-list-issues-url.png" class="image-simple" alt="Postman new request list issues URL" /></td>
    <td>Set requestâ€™s name to â€œList issuesâ€, in the URL type <code>https://api.github.com/repos</code> and paste the <code>/user/repo/issues</code> part of the newly created repositoryâ€™s URL</td>
</tr>
</table>

<p><em>API design digression</em>
You obviously noticed that the UI URLs are similar to the API ones, in the case of Github thatâ€™s a really good idea because both UI and API give access to the exact same product and that helps developers to learn how works the API.
But note that it is not always a good idea to mimic your UI in your API as it can make it less reusable in other use cases.</p>

<p>We could stop here and hit the send button to list issues, but in order to keep our request and project maintainable and reusable, weâ€™ll replace user and repo by variables:</p>

<table class="tutorial-steps">
<tr>
    <td><img src="/images/batch-github-api-call-with-csv-and-postman-runner-and-visualizer/postman-set-variable-pop.png" class="image-simple" alt="Select text in URL to get set variable menu" /></td>
    <td>In the URL, select your <code>user</code> (mine is <code>arno-di-loreto</code>), a â€œSet as variableâ€ menu appears, click on it</td>
</tr>
<tr>
    <td><img src="/images/batch-github-api-call-with-csv-and-postman-runner-and-visualizer/postman-set-variable-menu.png" class="image-simple" alt="Set text as variable menu" /></td>
    <td>Click on â€œ+ Set as new variableâ€</td>
</tr>
<tr>
    <td><img src="/images/batch-github-api-call-with-csv-and-postman-runner-and-visualizer/postman-list-issues-github-user-variable-configuration.png" class="image-simple" alt="Github user variable configuration" /></td>
    <td>Set name to <code>github_user</code>, select â€œEnvironment: Githubâ€ scope and click on â€œSet Variableâ€</td>
</tr>
<tr>
    <td><img src="/images/batch-github-api-call-with-csv-and-postman-runner-and-visualizer/postman-list-issues-github-user-variable-url.png" class="image-simple" alt="Github user variable in URL" /></td>
    <td>User has been replaced by the variable <code>/repos/{{github_user}}/repo/issues</code>)</td>
</tr>
<tr>
    <td><img src="/images/batch-github-api-call-with-csv-and-postman-runner-and-visualizer/postman-list-issues-github-repo-variable-url.png" class="image-simple" alt="User and repo replaced by variables in URL" /></td>
    <td>Repeat with your <code>dummy repo name</code> to create a <code>github_repo</code> variable in Github environment</td>
</tr>
<tr>
    <td><img src="/images/batch-github-api-call-with-csv-and-postman-runner-and-visualizer/postman-list-issues-to-save.png" class="image-simple" alt="List issues request to save" /></td>
    <td>Donâ€™t forget to <img src="/images/batch-github-api-call-with-csv-and-postman-runner-and-visualizer/postman-save-button.png" class="image-inline" alt="Save button" /></td>
</tr>
<tr>
    <td><img src="/images/batch-github-api-call-with-csv-and-postman-runner-and-visualizer/postman-list-issues-empty.png" class="image-simple" alt="Empty issues list" /></td>
    <td>Now you can hit <img src="/images/batch-github-api-call-with-csv-and-postman-runner-and-visualizer/postman-send-button.png" class="image-inline" alt="Send button" /> and get an empty list as response because there are no issues in the newly created repository.</td>
</tr>
</table>

<h2 id="create-an-issue">Create an issue</h2>

<p>Letâ€™s fill that empty issues list by creating an issue.
As the Github REST API follows common practices, we are supposed to do a POST request on the same URL as the one used to list issues:</p>

<table class="tutorial-steps">
<tr>
    <td><img src="/images/batch-github-api-call-with-csv-and-postman-runner-and-visualizer/postman-create-issue-duplicate.png" class="image-simple" alt="Request duplicate menu" /></td>
    <td>Right click on the â€œList issuesâ€ request and select â€œDuplicateâ€</td>
</tr>
<tr>
    <td><img src="/images/batch-github-api-call-with-csv-and-postman-runner-and-visualizer/postman-create-issue-rename.png" class="image-simple" alt="Rename request with pen" /></td>
    <td>Select the newly created â€œList issues in repository Copyâ€ request and change its name to â€œCreate issueâ€ by clicking on the pen that appear next to the request name when hovering over it</td>
</tr>
<tr>
    <td><img src="/images/batch-github-api-call-with-csv-and-postman-runner-and-visualizer/postman-create-issue-change-method.png" class="image-simple" alt="Method menu" /></td>
    <td>Click on â€œGETâ€ to change method to â€œPOSTâ€ and then hit the <img src="/images/batch-github-api-call-with-csv-and-postman-runner-and-visualizer/postman-send-button.png" class="image-inline" alt="Send button" /> buttonâ€¦</td>
</tr>
<tr>
    <td><img src="/images/batch-github-api-call-with-csv-and-postman-runner-and-visualizer/postman-create-issue-error.png" class="image-simple" alt="Method menu" /></td>
    <td> â€¦ Oops, thereâ€™s a 422 error!</td>
</tr>
</table>

<p>We actually forgot to provide some data in the body, but the error <code>message</code> is totally unclear about that.</p>

<div class="card card-code text-white bg-dark border-dark">
  
  <div class="card-header">
    <div class="row m-0">
      <div class="col align-self-center">
        <p class="m-0 title">An error response that don't help as much as it could</p>
      </div>
      <div class="col col-auto pr-0">
        <div class="btn-group" role="group" aria-label="code snippet control">
          <a role="button" class="btn btn-secondary code-copy-btn border-0 rounded-0" aria-label="copy" data-toggle="tooltip" data-placement="top" title="Copy"><img class="btn-icon" src="/images/commons/icons/copy.svg" /></a>
          
        </div>
      </div>
    </div>
  </div>
  <div class="card-body">
    <pre class="language-json line-numbers code-copy"><code class="code-block">{
    &quot;message&quot;: &quot;Invalid request.\n\nFor &#39;links/0/schema&#39;, nil is not an object.&quot;,
    &quot;documentation_url&quot;: &quot;https://docs.github.com/rest/reference/issues#create-an-issue&quot;
}</code></pre>
  </div>
</div>

<p>Such cryptic response is really an example to NOT follow, an error message must clear and help to solve the problem.
But at least, thereâ€™s a <a href="https://docs.github.com/rest/reference/issues#create-an-issue">link</a> to the documentation (<code>documentation_url</code>) (which is a very good idea!), if you follow it youâ€™ll see that we need to supply at least a <code>title</code> and there are other data such as the <code>body</code>.</p>

<p>Letâ€™s try set this request a body but just with the <code>body</code> property:</p>

<table class="tutorial-steps">
<tr>
    <td><img src="/images/batch-github-api-call-with-csv-and-postman-runner-and-visualizer/postman-create-issue-body-tab.png" class="image-simple" alt="Request body tab" /></td>
    <td>Go to the "Body" tab</td>
</tr>
<tr>
    <td><img src="/images/batch-github-api-call-with-csv-and-postman-runner-and-visualizer/postman-create-issue-raw-selected.png" class="image-simple" alt="Request body raw button radio" /></td>
    <td>Click on "raw" button radio</td>
</tr>
<tr>
    <td><img src="/images/batch-github-api-call-with-csv-and-postman-runner-and-visualizer/postman-create-issue-json-selected.png" class="image-simple" alt="Request body raw button radio" /></td>
    <td>Click on the "Text" menu to select "JSON"</td>
</tr>
<tr>
    <td><img src="/images/batch-github-api-call-with-csv-and-postman-runner-and-visualizer/postman-create-issue-body-json.png" class="image-simple" alt="Request body raw button radio" /></td>
    <td>Add a JSON object with a â€œbodyâ€ property set to some random string (you can copy the following sample)</td>
</tr>
</table>

<div class="card card-code text-white bg-dark border-dark">
  
  <div class="card-header">
    <div class="row m-0">
      <div class="col align-self-center">
        <p class="m-0 title">Create issue (incomplete) body</p>
      </div>
      <div class="col col-auto pr-0">
        <div class="btn-group" role="group" aria-label="code snippet control">
          <a role="button" class="btn btn-secondary code-copy-btn border-0 rounded-0" aria-label="copy" data-toggle="tooltip" data-placement="top" title="Copy"><img class="btn-icon" src="/images/commons/icons/copy.svg" /></a>
          
        </div>
      </div>
    </div>
  </div>
  <div class="card-body">
    <pre class="language-json line-numbers code-copy"><code class="code-block">{
    &quot;body&quot;: &quot;Body of issue created by Postman&quot;
}</code></pre>
  </div>
</div>

<p>Now, if you hit <img src="/images/batch-github-api-call-with-csv-and-postman-runner-and-visualizer/postman-send-button.png" class="image-inline" alt="Send button" /> , it fails again with the following response:</p>

<div class="card card-code text-white bg-dark border-dark">
  
  <div class="card-header">
    <div class="row m-0">
      <div class="col align-self-center">
        <p class="m-0 title">An error response that actually helps</p>
      </div>
      <div class="col col-auto pr-0">
        <div class="btn-group" role="group" aria-label="code snippet control">
          <a role="button" class="btn btn-secondary code-copy-btn border-0 rounded-0" aria-label="copy" data-toggle="tooltip" data-placement="top" title="Copy"><img class="btn-icon" src="/images/commons/icons/copy.svg" /></a>
          
        </div>
      </div>
    </div>
  </div>
  <div class="card-body">
    <pre class="language-json line-numbers code-copy"><code class="code-block">{
    &quot;message&quot;: &quot;Invalid request.\n\n\&quot;title\&quot; wasn&#39;t supplied.&quot;,
    &quot;documentation_url&quot;: &quot;https://docs.github.com/rest/reference/issues#create-an-issue&quot;
}</code></pre>
  </div>
</div>

<p>But the error is clearer this time, we know exactly how to fix the problem: add missing <code>title</code> property.
Think about that the next time you design and then code an API.
OK, end of API design digression, letâ€™s provide a valid request body with a <code>title</code> and a <code>body</code>:</p>

<div class="card card-code text-white bg-dark border-dark">
  
  <div class="card-header">
    <div class="row m-0">
      <div class="col align-self-center">
        <p class="m-0 title">Create issue (complete) body</p>
      </div>
      <div class="col col-auto pr-0">
        <div class="btn-group" role="group" aria-label="code snippet control">
          <a role="button" class="btn btn-secondary code-copy-btn border-0 rounded-0" aria-label="copy" data-toggle="tooltip" data-placement="top" title="Copy"><img class="btn-icon" src="/images/commons/icons/copy.svg" /></a>
          
        </div>
      </div>
    </div>
  </div>
  <div class="card-body">
    <pre class="language-json line-numbers code-copy"><code class="code-block">{
    &quot;title&quot;: &quot;Issue created by Postman&quot;,
    &quot;body&quot;: &quot;Body of issue created by Postman&quot;
}</code></pre>
  </div>
</div>

<p>Click on <img src="/images/batch-github-api-call-with-csv-and-postman-runner-and-visualizer/postman-save-button.png" class="image-inline" alt="Save button" /> and hit <img src="/images/batch-github-api-call-with-csv-and-postman-runner-and-visualizer/postman-send-button.png" class="image-inline" alt="Send button" /> one more time, youâ€™ll get a <code>201 Created</code> response containing all data of the created issue.
If you go back to the â€œList issuesâ€ request to send it again, you should get an non empty list containing the created issue.
Obviously, if you also go the dummy repository on Github, youâ€™ll find that issue in the issues tab (I have to admit that I find quite satisfying to see the result of API calls appearing in UI).</p>

<h2 id="creating-many-github-issues-with-postman-runner-and-csv">Creating many github issues with Postman Runner and CSV</h2>

<p>If you need to create many issues, you could just modify the â€œCreate issueâ€ requestâ€™s body and hit <img src="/images/batch-github-api-call-with-csv-and-postman-runner-and-visualizer/postman-send-button.png" class="image-inline" alt="Send button" /> as many times as needed.
But that would be quite cumbersome right? What about trying the lazy way?</p>

<table class="tutorial-steps">
<tr>
    <td><img src="/images/batch-github-api-call-with-csv-and-postman-runner-and-visualizer/postman-create-issue-save.png" class="image-simple" alt="Unsaved create issue request" /></td>
    <td>Just in case, ensure you actually saved the â€œCreate Issueâ€</td>
</tr>
<tr>
    <td><img src="/images/batch-github-api-call-with-csv-and-postman-runner-and-visualizer/postman-github-collection-duplicate.png" class="image-simple" alt="Github collection duplicate menu" /></td>
    <td>Right click on the â€œGithubâ€ collection and select â€œDuplicateâ€</td>
</tr>
<tr>
    <td><img src="/images/batch-github-api-call-with-csv-and-postman-runner-and-visualizer/postman-github-collection-copy-rename-duplicate.png" class="image-simple" alt="Github collection rename menu" /></td>
    <td>Right click on the â€œGithub Copyâ€ collection and select â€œRenameâ€ to rename it â€œGithub Batch Issues Createâ€</td>
</tr>
<tr>
    <td><img src="/images/batch-github-api-call-with-csv-and-postman-runner-and-visualizer/postman-github-batch-create-collection-clean.png" class="image-simple" alt="Request delete menu" /></td>
    <td>Delete all requests EXCEPT the â€œCreate Issueâ€ one by right clicking on their name and selecting Delete</td>
</tr>
<tr>
    <td><img src="/images/batch-github-api-call-with-csv-and-postman-runner-and-visualizer/postman-github-batch-create-issue-body.png" class="image-simple" alt="Request body with variables" /></td>
    <td>Select the â€œCreate Issueâ€ request, select the body tab and replace <code>title</code> and <code>body</code> values by <code>{{title}}</code> and <code>{{body}}</code> variables as follow</td>
</tr>
</table>

<div class="card card-code text-white bg-dark border-dark">
  
  <div class="card-header">
    <div class="row m-0">
      <div class="col align-self-center">
        <p class="m-0 title">Create issue request's body with variables</p>
      </div>
      <div class="col col-auto pr-0">
        <div class="btn-group" role="group" aria-label="code snippet control">
          <a role="button" class="btn btn-secondary code-copy-btn border-0 rounded-0" aria-label="copy" data-toggle="tooltip" data-placement="top" title="Copy"><img class="btn-icon" src="/images/commons/icons/copy.svg" /></a>
          
        </div>
      </div>
    </div>
  </div>
  <div class="card-body">
    <pre class="language-json line-numbers code-copy"><code class="code-block">{
    &quot;title&quot;: &quot;{{title}}&quot;,
    &quot;body&quot;: &quot;{{body}}&quot;
}</code></pre>
  </div>
</div>

<p>But from where will come those variables?
From a CSV (Comma Separated Values) file!
Open your favorite text editor, and put some issues titles and bodies as follow and save the file somewhere.
The first line contains the names of the variables (<code>title</code> and <code>body</code>), the other lines contain actual titles and bodies.</p>

<div class="card card-code text-white bg-dark border-dark">
  
  <div class="card-header">
    <div class="row m-0">
      <div class="col align-self-center">
        <p class="m-0 title">Issues data in CSV format</p>
      </div>
      <div class="col col-auto pr-0">
        <div class="btn-group" role="group" aria-label="code snippet control">
          <a role="button" class="btn btn-secondary code-copy-btn border-0 rounded-0" aria-label="copy" data-toggle="tooltip" data-placement="top" title="Copy"><img class="btn-icon" src="/images/commons/icons/copy.svg" /></a>
          
        </div>
      </div>
    </div>
  </div>
  <div class="card-body">
    <pre class="language-csv line-numbers code-copy"><code class="code-block">title,body
A first issue, First issue&#39;s body
Another issue, Second issue&#39;s body
Third issue,Yet another issue&#39;s body
Fourth issue,Too many issues
Five,It doesn&#39;t work
Six,It really doesn&#39;t work</code></pre>
  </div>
</div>

<p>Now, we will trigger one API call per CSV file line (excluding the first one which holds the variable names):</p>

<table class="tutorial-steps">
<tr>
    <td><img src="/images/batch-github-api-call-with-csv-and-postman-runner-and-visualizer/postman-github-batch-run.png" class="image-simple" alt="Collection run button" /></td>
    <td>Select the â€œGithub Batch Issues Createâ€ collection and click on the â€œRunâ€ button</td>
</tr>
<tr>
    <td><img src="/images/batch-github-api-call-with-csv-and-postman-runner-and-visualizer/postman-github-batch-open-csv.png" class="image-simple" alt="Select CSV file" /></td>
    <td>Click on â€œSelect Fileâ€ and open the previously created CSV file</td>
</tr>
<tr>
    <td><img src="/images/batch-github-api-call-with-csv-and-postman-runner-and-visualizer/postman-github-batch-preview-open.png" class="image-simple" alt="CSV data preview" /></td>
    <td>Note that the number of iterations matches the number of line (minus title one) in the CSV file. Click on the â€œPreviewâ€ button</td>
</tr>
<tr>
    <td><img src="/images/batch-github-api-call-with-csv-and-postman-runner-and-visualizer/postman-github-batch-preview.png" class="image-simple" alt="CSV data preview" /></td>
    <td>Check that the file is correctly interpreted, then close the preview</td>
</tr>
<tr>
    <td><img src="/images/batch-github-api-call-with-csv-and-postman-runner-and-visualizer/postman-github-batch-run-launch.png" class="image-simple" alt="Launch run button" /></td>
    <td>And finally, hit â€œRun Github Batch Issues Createâ€ button</td>
</tr>
</table>

<p>Postman will do all the work and create all the issues provided in the CSV file.
It simply makes and API call for each line, replacing the <code>{{title}}</code> and <code>{{body}}</code> variables by the value provided the CSV fileâ€™s line.</p>

<div class="image border">
    <figure class="figure">
        <img src="/images/batch-github-api-call-with-csv-and-postman-runner-and-visualizer/postman-github-batch-result.png" class="figure-img img-fluid" alt="Run result" /></figure>
</div>

<p>You can list issues with an API call of check Github web site to see all the created issues.
Note that there are 7 issues, thatâ€™s the one created to check our Create Issue API call was actually working plus the six other ones created with the CSV file.</p>

<div class="image border">
    <figure class="figure">
        <img src="/images/batch-github-api-call-with-csv-and-postman-runner-and-visualizer/postman-github-batch-result-github.png" class="figure-img img-fluid" alt="Issues list on github website" /></figure>
</div>

<h1 id="it-works-also-on-the-command-line">It works also on the command line</h1>

<p>If you need to industrialize doing batch API calls this way, having to use UI is not really convenient.
Hopefully, you can run collection on the command line using Postmanâ€™s Newman.
So, letâ€™s see how to create many Github issues using our â€œGithub Batch Issues Createâ€ collection and Newman.</p>

<h2 id="install-newman">Install Newman</h2>

<p>Youâ€™ll need <a href="https://nodejs.org/en/download/current/">Node.js</a> to install and run Newman.
Installing Newman is quite simple, just open a terminal and run a good old <code>npm install -g newman</code> and youâ€™re done.
Check Newman <a href="https://learning.postman.com/docs/running-collections/using-newman-cli/command-line-integration-with-newman/">documentation</a> for more information.</p>

<h2 id="export-collection-and-environment-file">Export collection and environment file</h2>

<p>To run the â€œGithub Batch Issues Createâ€ collection, we obviously need the collection itself but also the â€œGithubâ€ environment variables, letâ€™s export them both:</p>

<table class="tutorial-steps">
<tr>
    <td><img src="/images/batch-github-api-call-with-csv-and-postman-runner-and-visualizer/postman-export-collection-menu.png" class="image-simple" alt="Collection menu" /></td>
    <td>Click on â€¦ near the â€œGithub Batch Issues Createâ€ collection name and select â€œExportâ€</td>
</tr>
<tr>
    <td><img src="/images/batch-github-api-call-with-csv-and-postman-runner-and-visualizer/postman-export-collection-dialog.png" class="image-simple" alt="Export collection dialog" /></td>
    <td>Keep default export format, click the â€œExportâ€ button and save the collection file in the same folder as the CSV file created earlier</td>
</tr>
<tr>
    <td><img src="/images/batch-github-api-call-with-csv-and-postman-runner-and-visualizer/postman-environments.png" class="image-simple" alt="Environment tab" /></td>
    <td>Go to the â€œEnvironmentâ€ tab (in Postmanâ€™s window left panel) and select the Github environment by clicking on it</td>
</tr>
<tr>
    <td><img src="/images/batch-github-api-call-with-csv-and-postman-runner-and-visualizer/postman-environment-menu.png" class="image-simple" alt="Environment menu" /></td>
    <td>Click on â€¦ near the Share button (upper right corner), select â€œExportâ€ and save the environment file in the same folder as the CSV file</td>
</tr>
</table>

<h2 id="creating-many-github-issues-on-command-line-with-newman">Creating many github issues on command line with Newman</h2>

<p>Now, weâ€™re all set to run the â€œGithub Batch Issues Createâ€ collection on the command line:</p>

<ul>
  <li>Open a terminal</li>
  <li>Go to the folder containing the csv, collection and environment files</li>
  <li>Run <code>newman run collection_filename -e environment_filename -d csv_filename</code> (with your actual collection, environment and csv filenames!)</li>
</ul>

<p>And tada, one â€œCreate Issueâ€ request has been done for each line in the CSV file (again)!</p>

<div class="image ">
    <figure class="figure">
        <img src="/images/batch-github-api-call-with-csv-and-postman-runner-and-visualizer/newman-result.png" class="figure-img img-fluid" alt="Newman execution result" /></figure>
</div>

<p>You can optionally check the newly created issued in Postman with the List issues request or go on Github.
Note that as we didnâ€™t modify the CSV file between the Postman and Newman run, the 6 new issues are the same as the 6 previous ones.</p>

<h1 id="cleaning-the-mess-with-github-graphql-api">Cleaning the mess with Github GraphQL API</h1>

<p>As an exercise you can try to delete the issues that has been created using Postman (or Newman), a collection and a CSV file containing ids of issues to delete.
Do not overlook this exercise that looks quite simple but is actually not, there is a trap and a interesting Postman feature to discover.</p>

<p><strong>Spoiler</strong></p>

<p>The rest of this section shows how to do so (with less screenshots as by now you should know how to find your way in Postman UI).</p>

<h2 id="trying-to-delete-an-issue">Trying to delete an issue</h2>

<p>As the Github API is a REST API, I assume that deleting an issue simply means sending a <code>DELETE /issues-resource-path/{issueId}</code> request.
To find the actual URL, letâ€™s use the â€œList issuesâ€ request again, it returns something like that:</p>

<div class="card card-code text-white bg-dark border-dark">
  
  <div class="card-header">
    <div class="row m-0">
      <div class="col align-self-center">
        <p class="m-0 title"></p>
      </div>
      <div class="col col-auto pr-0">
        <div class="btn-group" role="group" aria-label="code snippet control">
          <a role="button" class="btn btn-secondary code-copy-btn border-0 rounded-0" aria-label="copy" data-toggle="tooltip" data-placement="top" title="Copy"><img class="btn-icon" src="/images/commons/icons/copy.svg" /></a>
          
        </div>
      </div>
    </div>
  </div>
  <div class="card-body">
    <pre class="language-json line-numbers code-copy"><code class="code-block">[
    {
        &quot;url&quot;: &quot;https://api.github.com/repos/arno-di-loreto/postman-csv-demo/issues/13&quot;,
        &quot;repository_url&quot;: &quot;https://api.github.com/repos/arno-di-loreto/postman-csv-demo&quot;,
        &quot;labels_url&quot;: &quot;https://api.github.com/repos/arno-di-loreto/postman-csv-demo/issues/13/labels{/name}&quot;,
        &quot;comments_url&quot;: &quot;https://api.github.com/repos/arno-di-loreto/postman-csv-demo/issues/13/comments&quot;,
        &quot;events_url&quot;: &quot;https://api.github.com/repos/arno-di-loreto/postman-csv-demo/issues/13/events&quot;,
        &quot;html_url&quot;: &quot;https://github.com/arno-di-loreto/postman-csv-demo/issues/13&quot;,
        &quot;id&quot;: 848749267,
        &quot;node_id&quot;: &quot;MDU6SXNzdWU4NDg3NDkyNjc=&quot;,
        &quot;number&quot;: 13,
        ...
    },
    ...
]</code></pre>
  </div>
</div>

<p>A github issue seems to have 3 â€œidsâ€: <code>id</code>, <code>node_id</code> and <code>number</code>, which one to choose?
No need to actually think about it because the ready to use <code>url</code> is actually provided!
Thatâ€™s pretty handy.
And by the way it tells us that the id to use is <code>number</code> (with user and repo name).</p>

<p>Letâ€™s try to delete the first issue in the list:</p>

<ul>
  <li>Click on the url propertyâ€™s value</li>
  <li>That opens a new request tab</li>
  <li>Hit the Send button to check what happens when doing a GET on that URL</li>
  <li>You actually get the issue</li>
  <li>Now change method to DELETE and hit send again â€¦</li>
</ul>

<p>That returns a <code>404 Not Found</code>, does that mean this issue doesnâ€™t exist?!
Obviously not, because a GET on it actually returned something.
Letâ€™s check what the <a href="https://docs.github.com/rest">documentation</a> says (link provided in <code>documentation_url</code>), look for <a href="https://docs.github.com/en/rest/reference/issues">Issues</a> in the left navigation bar.</p>

<p>Actually, you canâ€™t delete an issue with Github REST API!</p>

<p>Seriously, donâ€™t do that at home, use HTTP protocol correctly, never, ever return a 404 Not Found when a method is not available, return a 405 Method Not Allowed instead.</p>

<h2 id="actually-deleting-an-issue">Actually deleting an issue</h2>

<p>Hopefully there are 2 Github APIs: the REST one and the GraphQL one.
And you can delete issues with Github GraphQL API using the <code>deleteIssue</code> mutation.
And even more hopefully, you can use the same token to access both APIs.</p>

<p>I will not go into details about GraphQL.
For what we need to do today, you only need to know that to send requests to a GraphQL API you always use a POST request and tell what you want to do in the body using GraphQL query language.
In GraphQL, a request can contains many queries (to read data) and mutations (to modify data), actually mutations can be seen as functions.
You can read my <a href="/and-graphql-for-all-a-few-things-to-think-about-before-blindly-dumping-rest-for-graphql/">And GraphQL for all</a> post to learn more about GraphQL.</p>

<p>Letâ€™s try to use this <code>deleteIssue</code> mutation:</p>

<ul>
  <li>Select the â€œGithubâ€ collection</li>
  <li>Create a new â€œDelete issue (GraphQL)â€ request</li>
  <li>Set its method to â€œPOSTâ€</li>
  <li>Set its URL to <code>https://api.github.com/graphql</code></li>
  <li>Go to the â€œBodyâ€ tab</li>
  <li>Select â€œGraphQLâ€ radio button</li>
  <li>Paste the following GraphQL body</li>
</ul>

<div class="card card-code text-white bg-dark border-dark">
  
  <div class="card-header">
    <div class="row m-0">
      <div class="col align-self-center">
        <p class="m-0 title">Delete issue GraphQl request body</p>
      </div>
      <div class="col col-auto pr-0">
        <div class="btn-group" role="group" aria-label="code snippet control">
          <a role="button" class="btn btn-secondary code-copy-btn border-0 rounded-0" aria-label="copy" data-toggle="tooltip" data-placement="top" title="Copy"><img class="btn-icon" src="/images/commons/icons/copy.svg" /></a>
          
        </div>
      </div>
    </div>
  </div>
  <div class="card-body">
    <pre class="language-graphql line-numbers code-copy"><code class="code-block">mutation {
    deleteIssue(input: { issueId: &quot;but which id put here?&quot; }) { 
        repository { 
            name
        }
    }
}</code></pre>
  </div>
</div>

<p>The question is, which id should we provide in the <code>issueId</code> property?
We have seen in the REST API that an issue has 3 different ids, for example:</p>

<ul>
  <li><code>id</code>: <code>848749267</code></li>
  <li><code>node_id</code>: <code>MDU6SXNzdWU4NDg3NDkyNjc=</code></li>
  <li><code>number</code>: <code>13</code></li>
</ul>

<p>As the request does not provide the repository name, that excludes the <code>number</code> as its value is probably not universally unique across all repositories of all users.
The <code>id</code> and <code>node_id</code> could be that unique.</p>

<p>Try to set <code>issueId</code> with one of the <code>id</code> of your issues and hit the send button.
Youâ€™ll get this 200 OK response (sighâ€¦ HTTP is only used for transport with GraphQL APIs):</p>

<div class="card card-code text-white bg-dark border-dark">
  
  <div class="card-header">
    <div class="row m-0">
      <div class="col align-self-center">
        <p class="m-0 title">Error</p>
      </div>
      <div class="col col-auto pr-0">
        <div class="btn-group" role="group" aria-label="code snippet control">
          <a role="button" class="btn btn-secondary code-copy-btn border-0 rounded-0" aria-label="copy" data-toggle="tooltip" data-placement="top" title="Copy"><img class="btn-icon" src="/images/commons/icons/copy.svg" /></a>
          
        </div>
      </div>
    </div>
  </div>
  <div class="card-body">
    <pre class="language-graphql line-numbers code-copy"><code class="code-block">{
    &quot;data&quot;: {
        &quot;deleteIssue&quot;: null
    },
    &quot;errors&quot;: [
        {
            &quot;type&quot;: &quot;NOT_FOUND&quot;,
            &quot;path&quot;: [
                &quot;deleteIssue&quot;
            ],
            &quot;locations&quot;: [
                {
                    &quot;line&quot;: 2,
                    &quot;column&quot;: 5
                }
            ],
            &quot;message&quot;: &quot;Could not resolve to a node with the global id of &#39;848749267&#39;&quot;
        }
    ]
}</code></pre>
  </div>
</div>

<p>As <code>node_id</code> is the only one left and as the error message talks about â€œnodeâ€, it seems to be the expected value.
Try again, and now youâ€™ll get another 200 OK signifying that the issue has been deleted.</p>

<div class="card card-code text-white bg-dark border-dark">
  
  <div class="card-header">
    <div class="row m-0">
      <div class="col align-self-center">
        <p class="m-0 title">Issue deleted!</p>
      </div>
      <div class="col col-auto pr-0">
        <div class="btn-group" role="group" aria-label="code snippet control">
          <a role="button" class="btn btn-secondary code-copy-btn border-0 rounded-0" aria-label="copy" data-toggle="tooltip" data-placement="top" title="Copy"><img class="btn-icon" src="/images/commons/icons/copy.svg" /></a>
          
        </div>
      </div>
    </div>
  </div>
  <div class="card-body">
    <pre class="language-graphql line-numbers code-copy"><code class="code-block">{
    &quot;data&quot;: {
        &quot;deleteIssue&quot;: {
            &quot;repository&quot;: {
                &quot;name&quot;: &quot;dummy-repository&quot;
            }
        }
    }
}</code></pre>
  </div>
</div>

<p>Note that this response contains the name of the repo that was holding the deleted issue.
Now that you know how to delete an issue, itâ€™s quite easy to delete all the issue you have created.
I will just give you one last tip.</p>

<h2 id="one-last-tip-generating-csv-file-with-ids-in-postman">One last tip: â€œGeneratingâ€ CSV file with Ids in Postman</h2>

<p>To delete multiple issues using the method we have been using to create them, you need a CSV file containing the ids of the issues you want to delete.
You could list issues using Postman and copy/paste them one by one in that file.
You could also use the powerful JSON command line processor <code>jq</code> (see my <a href="/api-toolbox-jq-and-openapi-part-1-using-jq-to-extract-data-from-openapi-files/">post series</a> about it)
But what about â€œgeneratingâ€ that CSV in Postman?</p>

<p>To do so, weâ€™ll use the <a href="https://learning.postman.com/docs/sending-requests/visualizer/">Visualize</a> feature of Postman.
By adding some Javascript code in the Tests tab of a request you can setup a visualizer for the returned data.
That can be used to create awesome charts or more simple tables, this is what weâ€™ll do here.</p>

<p>Go the the Tests tab of the â€œList issuesâ€ request in â€œGithubâ€ collection and copy/paste the following Javascript code:</p>

<div class="card card-code text-white bg-dark border-dark">
  
  <div class="card-header">
    <div class="row m-0">
      <div class="col align-self-center">
        <p class="m-0 title">Setup visualizer in Tests tab</p>
      </div>
      <div class="col col-auto pr-0">
        <div class="btn-group" role="group" aria-label="code snippet control">
          <a role="button" class="btn btn-secondary code-copy-btn border-0 rounded-0" aria-label="copy" data-toggle="tooltip" data-placement="top" title="Copy"><img class="btn-icon" src="/images/commons/icons/copy.svg" /></a>
          
        </div>
      </div>
    </div>
  </div>
  <div class="card-body">
    <pre class="language-js line-numbers code-copy"><code class="code-block">// Handlebar template
var templateIdsOnly = `
    &lt;table bgcolor=&quot;#FFFFFF&quot;&gt;
        &lt;tr&gt;
            &lt;th&gt;issueId&lt;/th&gt;
        &lt;/tr&gt;

        {{#each response}}
            &lt;tr&gt;
                &lt;td&gt;{{node_id}}&lt;/td&gt;
            &lt;/tr&gt;
        {{/each}}
    &lt;/table&gt;
`;

// Set visualizer
pm.visualizer.set(templateIdsOnly, {
    // Pass the response body parsed as JSON as `data`
    response: pm.response.json()
});</code></pre>
  </div>
</div>

<p>This Javascript code creates a <code>templateIdsOnly</code> <a href="https://handlebarsjs.com/">Handlebar</a> template.
This template is pretty basic, it builds a HTML table with a single column title <code>issueId</code>.
This table will contain a line line holding the <code>node_id</code> value of each item returned by the API call. 
After that it configures the Postman visualizer (<code>pm.visualizer</code>) to use the template on the API cal response data (<code>pm.response.json()</code>).</p>

<p>Once this is done, hit the Send button and click on Visualize in the response and tada, you get a one column table with its node_id title and all node_id values:</p>

<div class="image border">
    <figure class="figure">
        <img src="/images/batch-github-api-call-with-csv-and-postman-runner-and-visualizer/postman-visualize-ids.png" class="figure-img img-fluid" alt="Visualize result in Postman" /></figure>
</div>

<p>Just select all text and copy/paste it in a file that youâ€™ll use as input to delete all issues.</p>

<p>Obviously, in our case as we need a single value for each request, that is not really a CSV file that has been â€œgeneratedâ€.
If you need to get multiple value, just add a comma and the new value in the template (donâ€™t forget title) as follow</p>

<div class="card card-code text-white bg-dark border-dark">
  
  <div class="card-header">
    <div class="row m-0">
      <div class="col align-self-center">
        <p class="m-0 title">Actually generating CSV data</p>
      </div>
      <div class="col col-auto pr-0">
        <div class="btn-group" role="group" aria-label="code snippet control">
          <a role="button" class="btn btn-secondary code-copy-btn border-0 rounded-0" aria-label="copy" data-toggle="tooltip" data-placement="top" title="Copy"><img class="btn-icon" src="/images/commons/icons/copy.svg" /></a>
          
        </div>
      </div>
    </div>
  </div>
  <div class="card-body">
    <pre class="language-js line-numbers code-copy"><code class="code-block">// Handlebar template
var templateCsv = `
    &lt;table bgcolor=&quot;#FFFFFF&quot;&gt;
        &lt;tr&gt;
            &lt;th&gt;issueId,body&lt;/th&gt;
        &lt;/tr&gt;

        {{#each response}}
            &lt;tr&gt;
                &lt;td&gt;{{node_id}},{{body}}&lt;/td&gt;
            &lt;/tr&gt;
        {{/each}}
    &lt;/table&gt;
`;

// Set visualizer
pm.visualizer.set(templateCsv, {
    // Pass the response body parsed as JSON as `data`
    response: pm.response.json()
});</code></pre>
  </div>
</div>

<p>From now on, you have all you need to delete multiple issues with the runner in Postman or with Newman.</p>

<h1 id="delete-access-token">Delete access token</h1>

<p>Once youâ€™re done, beware to not commit the environnement file with active access token.
I recommend deleting your Github access token if you donâ€™t use it anymore.
Go to your <a href="https://github.com/settings/tokens">Personal Access Token list</a> on Github and click on the â€œdeleteâ€ button for the â€œpostman-csv-demoâ€ token.</p>

<h1 id="lessons-learned">Lessons learned</h1>

<p>I hope that the next time youâ€™ll need to batch API calls, youâ€™ll remember what youâ€™ve seen in this post.
Doing CSV data based API batch calls is pretty simple once you know that feature exists in Postman (and in its command line counter part Newman).
The visualize feature can be really useful too in that case but it can be used to do far more advanced data rendering.
And donâ€™t forget to use environment variables to store sensitive data in Postman.</p>

<p>I hope that youâ€™ll also remember the few design principles and errors that we have seen:</p>

<ul>
  <li>Being consistent with common practices (and HTTP/REST principles), ease learning to use an API (people can guess how to use APIs)</li>
  <li>Including link to documentation is quite useful</li>
  <li>Never return unclear error that does not help to solve the problem</li>
  <li>Never return 404 Not Found status code when an HTTP method is not available on an actually existing resource, use 405 Method Not Allowed instead</li>
  <li>Having consistent URL between UI and API can be a good idea but not always (it may make API less reusable)</li>
</ul>

<p>And last but not least, weâ€™ve seen that even famous companies such as Github can make mistakes with their APIs.
That means that you must be careful when taking inspiration from existing APIs.
Hopefully, in the case of Github, the problems donâ€™t have much consequences, the API is overall of good quality and usable (and the documentation is quite good), but be careful not to ruin developer experience with more terrible mistakes.</p>

:ET